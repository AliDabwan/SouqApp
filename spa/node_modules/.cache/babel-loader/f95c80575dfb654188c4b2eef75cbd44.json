{"ast":null,"code":"import _regeneratorRuntime from\"D:/Learn/react/SouqApp/spa/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Learn/react/SouqApp/spa/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Learn/react/SouqApp/spa/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Box}from\"@mui/material\";import{Route,Routes}from\"react-router-dom\";import{ToastContainer}from\"react-toastify\";import AboutUs from\"../../features/about/AboutUs\";import Catalog from\"../../features/catalog/Catalog\";import ProductDetails from\"../../features/catalog/ProductDetails\";import ContactUs from\"../../features/contact/ContactUs\";import Header from\"./Header\";import'react-toastify/dist/ReactToastify.css';import ServerError from\"../errors/ServerError\";import NotFound from\"../errors/NotFound\";import BasketPage from\"../../features/basket/BasketPage\";// import { useSouqContext } from \"../context/SouqContext\";\nimport{useCallback,useEffect,useState}from\"react\";import Loader from\"./Loader\";import{useAppDispatch}from\"../store/configureStore\";import{fetchBasketAsync}from\"../../features/basket/basketSlice\";import Register from\"../../features/account/Register\";import Login from\"../../features/account/Login\";import{fetchCurrentUser}from\"../../features/account/accountSlice\";import ProtectedRout from\"./ProtectedRout\";import Orders from\"../../features/orders/Orders\";import CheckoutWrapper from\"../../features/checkout/CheckoutWrapper\";import Inventory from\"../../features/admin/Inventory\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){// const {setBasket}=useSouqContext();\nvar dispatch=useAppDispatch();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var myRols;(function(myRols){myRols[\"Admin\"]=\"Admin\";myRols[\"Member\"]=\"Member\";})(myRols||(myRols={}));var initApp=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return dispatch(fetchCurrentUser());case 3:_context.next=5;return dispatch(fetchBasketAsync());case 5:_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[dispatch]);useEffect(function(){// dispatch(fetchCurrentUser());\n// const buyerId=Cookies.get('buyerId');\n// if(buyerId){\n//   // agent.Basket.get()\n//   // .then(basket=>setBasket(basket))\n//   // .catch(error=>console.log(error))\n//   // .finally(()=>setLoading(false))\n//   agent.Basket.get()\n//   .then(basket=>dispatch(setBasket(basket)))\n//   .catch(error=>console.log(error))\n//   .finally(()=>setLoading(false))\n// }else{\n//   setLoading(false)\n//   console.log('error')\n// }\ninitApp().then(function(){return setLoading(false);});},[initApp]);if(loading)return/*#__PURE__*/_jsx(Loader,{message:\"Loading App...!!!\"});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ToastContainer,{theme:\"colored\",position:\"bottom-right\",autoClose:3000,hideProgressBar:true}),/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Box,{sx:{mt:7,mb:2,px:2},children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Catalog,{})}),/*#__PURE__*/_jsx(Route,{path:\"catalog\",element:/*#__PURE__*/_jsx(Catalog,{})}),/*#__PURE__*/_jsx(Route,{path:\"catalog/:id\",element:/*#__PURE__*/_jsx(ProductDetails,{})}),/*#__PURE__*/_jsx(Route,{path:\"about\",element:/*#__PURE__*/_jsx(AboutUs,{})}),/*#__PURE__*/_jsx(Route,{path:\"contact\",element:/*#__PURE__*/_jsx(ContactUs,{})}),/*#__PURE__*/_jsx(Route,{path:\"basket\",element:/*#__PURE__*/_jsx(BasketPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"checkout\",element:/*#__PURE__*/_jsx(ProtectedRout,{children:/*#__PURE__*/_jsx(CheckoutWrapper,{})})}),/*#__PURE__*/_jsx(Route,{path:\"orders\",element:/*#__PURE__*/_jsx(ProtectedRout,{children:/*#__PURE__*/_jsx(Orders,{})})}),/*#__PURE__*/_jsx(Route,{path:\"inventory\",element:/*#__PURE__*/_jsx(ProtectedRout,{roles:[myRols.Admin],children:/*#__PURE__*/_jsx(Inventory,{})})}),/*#__PURE__*/_jsx(Route,{path:\"server-error\",element:/*#__PURE__*/_jsx(ServerError,{})}),/*#__PURE__*/_jsx(Route,{path:\"register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(NotFound,{})})]})})]});}export default App;","map":{"version":3,"sources":["D:/Learn/react/SouqApp/SPA/src/app/layout/App.tsx"],"names":["Box","Route","Routes","ToastContainer","AboutUs","Catalog","ProductDetails","ContactUs","Header","ServerError","NotFound","BasketPage","useCallback","useEffect","useState","Loader","useAppDispatch","fetchBasketAsync","Register","Login","fetchCurrentUser","ProtectedRout","Orders","CheckoutWrapper","Inventory","App","dispatch","loading","setLoading","myRols","initApp","console","log","then","mt","mb","px","Admin"],"mappings":"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","sourcesContent":["import { Box } from \"@mui/material\";\nimport { Route, Routes } from \"react-router-dom\";\nimport { ToastContainer } from \"react-toastify\";\nimport AboutUs from \"../../features/about/AboutUs\";\nimport Catalog from \"../../features/catalog/Catalog\";\nimport ProductDetails from \"../../features/catalog/ProductDetails\";\nimport ContactUs from \"../../features/contact/ContactUs\";\nimport Header from \"./Header\";\nimport 'react-toastify/dist/ReactToastify.css';\nimport ServerError from \"../errors/ServerError\";\nimport NotFound from \"../errors/NotFound\";\nimport BasketPage from \"../../features/basket/BasketPage\";\n// import { useSouqContext } from \"../context/SouqContext\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport Loader from \"./Loader\";\nimport { useAppDispatch } from \"../store/configureStore\";\nimport { fetchBasketAsync } from \"../../features/basket/basketSlice\";\nimport Register from \"../../features/account/Register\";\nimport Login from \"../../features/account/Login\";\nimport { fetchCurrentUser } from \"../../features/account/accountSlice\";\nimport ProtectedRout from \"./ProtectedRout\";\nimport Orders from \"../../features/orders/Orders\";\nimport CheckoutWrapper from \"../../features/checkout/CheckoutWrapper\";\nimport Inventory from \"../../features/admin/Inventory\";\n\nfunction App() {\n\n  // const {setBasket}=useSouqContext();\n\n  const dispatch=useAppDispatch();\n\n\n  const [loading, setLoading] = useState(true);\n\n  enum myRols {\n    Admin = 'Admin',\n    Member='Member'\n   \n  }\n\n\n\n\n  const initApp=useCallback(async()=>{\n    try {\n      await dispatch(fetchCurrentUser());\n      await dispatch(fetchBasketAsync());\n\n\n\n    } catch (error) {\n      console.log(error)\n    }\n  },[dispatch]) \n\n  useEffect(() => {\n\n    // dispatch(fetchCurrentUser());\n\n    // const buyerId=Cookies.get('buyerId');\n\n    // if(buyerId){\n    //   // agent.Basket.get()\n    //   // .then(basket=>setBasket(basket))\n    //   // .catch(error=>console.log(error))\n    //   // .finally(()=>setLoading(false))\n\n    //   agent.Basket.get()\n    //   .then(basket=>dispatch(setBasket(basket)))\n    //   .catch(error=>console.log(error))\n    //   .finally(()=>setLoading(false))\n\n\n\n \n    // }else{\n    //   setLoading(false)\n    //   console.log('error')\n\n    // }\n\n    initApp().then(()=>setLoading(false))\n\n  },[initApp] )\n  \n  if(loading)return<Loader message=\"Loading App...!!!\" />\n\n  \n\n  return (\n    <>\n      <ToastContainer theme=\"colored\" position=\"bottom-right\" autoClose={3000} hideProgressBar />\n      <Header />\n      <Box sx={{ mt: 7, mb: 2, px: 2 }}>\n        <Routes>\n          <Route path=\"/\" element={<Catalog />} />\n          <Route path=\"catalog\" element={<Catalog />} />\n          <Route path=\"catalog/:id\" element={<ProductDetails />} />\n          <Route path=\"about\" element={<AboutUs />} />\n          <Route path=\"contact\" element={<ContactUs />} />\n          <Route path=\"basket\" element={<BasketPage />} />\n          <Route path=\"checkout\" element={<ProtectedRout><CheckoutWrapper /></ProtectedRout> } />\n          <Route path=\"orders\" element={<ProtectedRout ><Orders/></ProtectedRout> } />\n          <Route path=\"inventory\" element={<ProtectedRout roles={[myRols.Admin]} ><Inventory/></ProtectedRout> } />\n\n          <Route path=\"server-error\" element={<ServerError />} />\n          <Route path=\"register\" element={<Register />} />\n          <Route path=\"login\" element={<Login />} />\n\n          <Route path=\"*\" element={<NotFound />} />\n        </Routes>\n      </Box>\n    </>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}