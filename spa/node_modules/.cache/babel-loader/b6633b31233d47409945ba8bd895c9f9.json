{"ast":null,"code":"var _jsxFileName = \"D:\\\\Learn\\\\react\\\\SouqApp\\\\spa\\\\src\\\\features\\\\catalog\\\\ProductDetails.tsx\",\n    _s = $RefreshSig$();\n\nimport Typography from '@mui/material/Typography';\nimport { useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport Grid from '@mui/material/Grid';\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\nimport agent from '../../app/api/agent';\nimport NotFound from '../../app/errors/NotFound';\nimport Loader from '../../app/layout/Loader';\nimport { currencyFormat } from '../../app/helper/helper';\nimport { useSouqContext } from '../../app/context/SouqContext';\nimport { LoadingButton } from '@mui/lab';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetails() {\n  _s();\n\n  const {\n    basket,\n    setBasket,\n    removeItem\n  } = useSouqContext();\n  const {\n    id\n  } = useParams();\n  const [product, setProduct] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [quantity, setQuantity] = useState(0);\n  const [submitting, setSubmitting] = useState(false);\n  const item = basket === null || basket === void 0 ? void 0 : basket.items.find(i => i.productId === (product === null || product === void 0 ? void 0 : product.id));\n  useEffect(() => {\n    document.body.style.background = 'inherit';\n    if (item) setQuantity(item.quantity);\n    agent.Catalog.details(id).then(product => setProduct(product)).catch(error => console.log(error)).finally(() => setLoading(false));\n  }, [id, item]);\n  useEffect(() => {\n    return () => {\n      document.body.style.background = '#e7e7e7';\n    };\n  }, []);\n\n  const handleInputChange = event => {\n    if (event.target.value >= 0) setQuantity(event === null || event === void 0 ? void 0 : event.target.value);\n  };\n\n  const handleUpdateCart = () => {\n    setSubmitting(true);\n\n    if (!item || quantity > item.quantity) {\n      if (quantity == 0) {\n        setQuantity(1);\n        console.log(quantity);\n      }\n\n      const updatedQuantity = item ? quantity - item.quantity : quantity;\n      agent.Basket.addItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity).then(basket => setBasket(basket)).catch(error => console.log(error)).finally(() => setSubmitting(false));\n    } else {\n      const updatedQuantity = item.quantity - quantity;\n      agent.Basket.deleteItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity).then(() => removeItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity)) // update the context\n      .catch(error => console.log(error)).finally(() => setSubmitting(false));\n    }\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(Loader, {\n    message: \"Loading Product...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n  if (!product) return /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 6,\n    marginTop: 0,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: product.pictureUrl,\n        alt: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h4\",\n        color: \"initial\",\n        children: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          borderBottomWidth: 'medium',\n          my: 2\n        },\n        variant: \"fullWidth\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        fontWeight: \"bolder\",\n        color: \"primary.dark\",\n        variant: \"h4\",\n        children: currencyFormat(product.price)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.type\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Brand\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 107,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.brand\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"In Stock\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 113,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.quantityInStock\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 2,\n        marginTop: 1,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(TextField, {\n            onChange: handleInputChange,\n            label: \"Quantity in cart\",\n            variant: \"outlined\",\n            type: \"number\",\n            fullWidth: true,\n            value: quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(LoadingButton, {\n            sx: {\n              height: '55px'\n            },\n            color: \"primary\",\n            size: \"large\",\n            variant: \"contained\",\n            fullWidth: true,\n            loading: submitting,\n            disabled: (item === null || item === void 0 ? void 0 : item.quantity) === quantity || !item && quantity === 0,\n            onClick: handleUpdateCart,\n            children: item ? 'Update Quantity' : 'Add To Cart'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ProductDetails, \"9bMpvRs8mkTcwdg+LI/gh75jjkA=\", false, function () {\n  return [useSouqContext, useParams];\n});\n\n_c = ProductDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductDetails\");","map":{"version":3,"sources":["D:/Learn/react/SouqApp/spa/src/features/catalog/ProductDetails.tsx"],"names":["Typography","useEffect","useState","useParams","Grid","Divider","Table","TableCell","TableContainer","TableHead","TableRow","TextField","agent","NotFound","Loader","currencyFormat","useSouqContext","LoadingButton","ProductDetails","basket","setBasket","removeItem","id","product","setProduct","loading","setLoading","quantity","setQuantity","submitting","setSubmitting","item","items","find","i","productId","document","body","style","background","Catalog","details","then","catch","error","console","log","finally","handleInputChange","event","target","value","handleUpdateCart","updatedQuantity","Basket","addItem","deleteItem","pictureUrl","name","borderBottomWidth","my","price","description","type","brand","quantityInStock","height"],"mappings":"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","sourcesContent":["import Typography from '@mui/material/Typography'\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router'\r\nimport { Product } from '../../app/models/product';\r\nimport Grid from '@mui/material/Grid'\r\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\r\nimport agent from '../../app/api/agent';\r\nimport NotFound from '../../app/errors/NotFound';\r\nimport Loader from '../../app/layout/Loader';\r\nimport { currencyFormat } from '../../app/helper/helper';\r\nimport { useSouqContext } from '../../app/context/SouqContext';\r\nimport { LoadingButton } from '@mui/lab';\r\n\r\nexport default function ProductDetails() {\r\n    const {basket,setBasket,removeItem}=useSouqContext();\r\n    const { id } = useParams();\r\n    const [product, setProduct] = useState<Product | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const [quantity,setQuantity]= useState(0);\r\n    const [submitting,setSubmitting]= useState(false);\r\n\r\n    const item=basket?.items.find(i=>i.productId===product?.id);\r\n\r\n\r\n    useEffect(() => {\r\n        document.body.style.background = 'inherit'\r\n        if(item)setQuantity(item.quantity);\r\n        agent.Catalog.details(id!)\r\n            .then(product => setProduct(product))\r\n            .catch(error => console.log(error))\r\n            .finally(() => setLoading(false))\r\n    }, [id,item])\r\n    useEffect(() => {\r\n        return () => {\r\n            document.body.style.background = '#e7e7e7'\r\n        }\r\n    }, [])\r\n\r\n    const handleInputChange= (event: any) =>{\r\n        if(event.target.value>=0)\r\n        setQuantity(event?.target.value);\r\n\r\n    }\r\n    const handleUpdateCart=()=>{\r\n        setSubmitting(true);\r\n        if(!item || quantity>item.quantity){\r\n            if(quantity==0){\r\n                setQuantity(1);\r\n                console.log(quantity);\r\n            }\r\n            const updatedQuantity=item?quantity-item.quantity:quantity;\r\n            agent.Basket.addItem(product?.id!,updatedQuantity)\r\n            .then(basket=>setBasket(basket))\r\n            .catch(error=>console.log(error))\r\n            .finally(()=>setSubmitting(false))\r\n        }else{\r\n            \r\n            const updatedQuantity=item.quantity-quantity;\r\n            agent.Basket.deleteItem(product?.id!,updatedQuantity)\r\n            .then(()=>removeItem(product?.id!,updatedQuantity)) // update the context\r\n            .catch(error=>console.log(error))\r\n            .finally(()=>setSubmitting(false))\r\n        }\r\n\r\n    } \r\n    if (loading) return (\r\n        <Loader message='Loading Product...' />\r\n    )\r\n    if (!product) return (\r\n        <NotFound />\r\n    )\r\n    return (\r\n        <Grid container spacing={6} marginTop={0}>\r\n            <Grid item xs={12} md={6}>\r\n                <img src={product.pictureUrl} alt={product.name} />\r\n            </Grid>\r\n            <Grid item xs={12} md={6}>\r\n                <Typography variant=\"h4\" color=\"initial\">{product.name}</Typography>\r\n                <Divider sx={{ borderBottomWidth: 'medium', my: 2 }} variant=\"fullWidth\" />\r\n                <Typography fontWeight=\"bolder\" color=\"primary.dark\" variant=\"h4\">\r\n                    {/* {(product.price / 100).toFixed(2)} EGP */}\r\n                    {currencyFormat(product.price)}\r\n                </Typography>\r\n                <TableContainer>\r\n                    <Table>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Name</TableCell>\r\n                                <TableCell>{product.name}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Description</TableCell>\r\n                                <TableCell>{product.description}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Type</TableCell>\r\n                                <TableCell>{product.type}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Brand</TableCell>\r\n                                <TableCell>{product.brand}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>In Stock</TableCell>\r\n                                <TableCell>{product.quantityInStock}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n\r\n                    </Table>\r\n                </TableContainer>\r\n                <Grid container spacing={2} marginTop={1}>\r\n                    <Grid item xs={6}>\r\n                        <TextField\r\n                        onChange={handleInputChange}\r\n                          label=\"Quantity in cart\"\r\n                          variant='outlined'\r\n                          type='number'\r\n                          fullWidth\r\n                          value={quantity}\r\n                        />\r\n\r\n\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                        <LoadingButton \r\n\r\n                        sx={{height:'55px'}}\r\n                        color='primary'\r\n                        size='large'\r\n                        variant='contained'\r\n                        fullWidth\r\n                        loading={submitting}\r\n                        disabled={item?.quantity===quantity || !item && quantity===0}\r\n                        onClick={handleUpdateCart}\r\n                        >\r\n                            {item?'Update Quantity':'Add To Cart'}\r\n\r\n                        </LoadingButton>\r\n\r\n\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n        </Grid>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}