{"ast":null,"code":"var _jsxFileName = \"D:\\\\Learn\\\\react\\\\SouqApp\\\\spa\\\\src\\\\features\\\\catalog\\\\ProductDetails.tsx\",\n    _s = $RefreshSig$();\n\nimport Typography from '@mui/material/Typography';\nimport { useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport Grid from '@mui/material/Grid';\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\nimport NotFound from '../../app/errors/NotFound';\nimport Loader from '../../app/layout/Loader';\nimport { currencyFormat } from '../../app/helper/helper';\nimport { LoadingButton } from '@mui/lab';\nimport { useAppDispatch, useAppSelector } from '../../app/store/configureStore';\nimport { addBasketItemAsync, removeBasketItemAsync } from '../basket/basketSlice';\nimport { fetchProductAsync, productSelectors } from './catalogSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetails() {\n  _s();\n\n  // const {basket,setBasket,removeItem}=useSouqContext(); context api\n  const {\n    status: productStatus\n  } = useAppSelector(state => state.catalog); // redux\n\n  const {\n    basket,\n    status\n  } = useAppSelector(state => state.basket); // redux\n\n  const dispatch = useAppDispatch();\n  const {\n    id\n  } = useParams(); // const [product, setProduct] = useState<Product | null>(null);\n\n  const product = useAppSelector(state => productSelectors.selectById(state, id)); // const [loading, setLoading] = useState(true);\n\n  const [quantity, setQuantity] = useState(0); // const [submitting,setSubmitting]= useState(false);\n\n  const item = basket === null || basket === void 0 ? void 0 : basket.items.find(i => i.productId === (product === null || product === void 0 ? void 0 : product.id));\n  useEffect(() => {\n    document.body.style.background = 'inherit';\n    if (item) setQuantity(item.quantity); // agent.Catalog.details(id!)\n    //     .then(product => setProduct(product))\n    //     .catch(error => console.log(error))\n    //     .finally(() => setLoading(false))\n\n    if (!product) dispatch(fetchProductAsync(id));\n  }, [id, item, product, dispatch]);\n  useEffect(() => {\n    return () => {\n      document.body.style.background = '#e7e7e7';\n    };\n  }, []);\n\n  const handleInputAddChange = event => {\n    console.log('add');\n    if (event.target.value > 0) setQuantity(event === null || event === void 0 ? void 0 : event.target.value);\n  };\n\n  const handleInputUpdateChange = event => {\n    console.log('update');\n    if (event.target.value >= 0) setQuantity(event === null || event === void 0 ? void 0 : event.target.value);\n  }; // const handleUpdateCartUsingContext=()=>{\n  //     setSubmitting(true);\n  //     if(!item || quantity>item.quantity){\n  //         var updatedQuantity=item?quantity-item.quantity:quantity;\n  //         if(updatedQuantity==0){\n  //             updatedQuantity=1;\n  //         }\n  //         agent.Basket.addItem(product?.id!,updatedQuantity)\n  //         .then(basket=>dispatch(setBasket(basket)))\n  //         .catch(error=>console.log(error))\n  //         .finally(()=>setSubmitting(false)\n  //         )\n  //     }else{\n  //         const updatedQuantity=item.quantity-quantity;\n  //         agent.Basket.deleteItem(product?.id!,updatedQuantity)\n  //         .then(()=>dispatch(removeItem({productId: product?.id!,quantity: updatedQuantity}))) // update the context\n  //         .catch(error=>console.log(error))\n  //         .finally(()=>  setSubmitting(false)\n  //         )\n  //     }\n  // } \n\n\n  const handleUpdateCart = () => {\n    if (!item || quantity > item.quantity) {\n      var updatedQuantity = item ? quantity - item.quantity : quantity;\n\n      if (updatedQuantity == 0) {\n        updatedQuantity = 1;\n      }\n\n      dispatch(addBasketItemAsync({\n        productId: product === null || product === void 0 ? void 0 : product.id,\n        quantity: updatedQuantity\n      }));\n    } else {\n      const updatedQuantity = item.quantity - quantity;\n      dispatch(removeBasketItemAsync({\n        productId: product === null || product === void 0 ? void 0 : product.id,\n        quantity: updatedQuantity\n      }));\n    }\n  }; // const doFainal=()=>{ \n  //     history.push('../basket');\n  // }\n\n\n  if (productStatus.includes('pending')) return /*#__PURE__*/_jsxDEV(Loader, {\n    message: \"Loading Product...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 9\n  }, this);\n  if (!product) return /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 9\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 6,\n    marginTop: 0,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: product.pictureUrl,\n        alt: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h4\",\n        color: \"initial\",\n        children: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          borderBottomWidth: 'medium',\n          my: 2\n        },\n        variant: \"fullWidth\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        fontWeight: \"bolder\",\n        color: \"primary.dark\",\n        variant: \"h4\",\n        children: currencyFormat(product.price)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.type\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Brand\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.brand\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"In Stock\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.quantityInStock\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 2,\n        marginTop: 1,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(TextField, {\n            onChange: item ? handleInputUpdateChange : handleInputAddChange,\n            label: \"Quantity in cart\",\n            variant: \"outlined\",\n            type: \"number\",\n            fullWidth: true,\n            value: quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(LoadingButton, {\n            sx: {\n              height: '55px'\n            },\n            color: \"primary\",\n            size: \"large\",\n            variant: \"contained\",\n            fullWidth: true,\n            loading: status.includes('pending'),\n            disabled: (item === null || item === void 0 ? void 0 : item.quantity) === quantity || !item && quantity === 0,\n            onClick: handleUpdateCart,\n            children: item ? 'Update Quantity' : 'Add To Cart'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ProductDetails, \"sKe5liVhhv55q/4XNnTAW6yGoIY=\", false, function () {\n  return [useAppSelector, useAppSelector, useAppDispatch, useParams, useAppSelector];\n});\n\n_c = ProductDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductDetails\");","map":{"version":3,"sources":["D:/Learn/react/SouqApp/spa/src/features/catalog/ProductDetails.tsx"],"names":["Typography","useEffect","useState","useParams","Grid","Divider","Table","TableCell","TableContainer","TableHead","TableRow","TextField","NotFound","Loader","currencyFormat","LoadingButton","useAppDispatch","useAppSelector","addBasketItemAsync","removeBasketItemAsync","fetchProductAsync","productSelectors","ProductDetails","status","productStatus","state","catalog","basket","dispatch","id","product","selectById","quantity","setQuantity","item","items","find","i","productId","document","body","style","background","handleInputAddChange","event","console","log","target","value","handleInputUpdateChange","handleUpdateCart","updatedQuantity","includes","pictureUrl","name","borderBottomWidth","my","price","description","type","brand","quantityInStock","height"],"mappings":"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","sourcesContent":["import Typography from '@mui/material/Typography'\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router'\r\nimport Grid from '@mui/material/Grid'\r\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\r\nimport NotFound from '../../app/errors/NotFound';\r\nimport Loader from '../../app/layout/Loader';\r\nimport { currencyFormat } from '../../app/helper/helper';\r\nimport { LoadingButton } from '@mui/lab';\r\nimport { useAppDispatch, useAppSelector } from '../../app/store/configureStore';\r\nimport {  addBasketItemAsync, removeBasketItemAsync } from '../basket/basketSlice';\r\nimport { fetchProductAsync, productSelectors } from './catalogSlice';\r\n\r\nexport default function ProductDetails() {\r\n\r\n    // const {basket,setBasket,removeItem}=useSouqContext(); context api\r\n    const {status:productStatus}=useAppSelector(state=>state.catalog); // redux\r\n\r\n    const {basket,status}=useAppSelector(state=>state.basket); // redux\r\n    const dispatch=useAppDispatch();\r\n\r\n\r\n    const { id } = useParams();\r\n\r\n    // const [product, setProduct] = useState<Product | null>(null);\r\n    const product=useAppSelector(state=>productSelectors.selectById(state,id!));\r\n\r\n\r\n    // const [loading, setLoading] = useState(true);\r\n\r\n    const [quantity,setQuantity]= useState(0);\r\n    // const [submitting,setSubmitting]= useState(false);\r\n\r\n    const item=basket?.items.find(i=>i.productId===product?.id);\r\n\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        document.body.style.background = 'inherit'\r\n        if(item)setQuantity(item.quantity);\r\n        // agent.Catalog.details(id!)\r\n        //     .then(product => setProduct(product))\r\n        //     .catch(error => console.log(error))\r\n        //     .finally(() => setLoading(false))\r\n        if(!product)dispatch(fetchProductAsync(id!));\r\n\r\n\r\n\r\n\r\n    }, [id,item,product,dispatch])\r\n    useEffect(() => {\r\n        return () => {\r\n            document.body.style.background = '#e7e7e7'\r\n        }\r\n    }, [])\r\n\r\n    const handleInputAddChange= (event: any) =>{\r\n        console.log('add');\r\n\r\n        if(event.target.value>0)\r\n        setQuantity(event?.target.value);\r\n\r\n\r\n    }\r\n    const handleInputUpdateChange= (event: any) =>{\r\n        console.log('update');\r\n\r\n        if(event.target.value>=0)\r\n        setQuantity(event?.target.value);\r\n\r\n    }\r\n\r\n\r\n\r\n    // const handleUpdateCartUsingContext=()=>{\r\n    //     setSubmitting(true);\r\n    //     if(!item || quantity>item.quantity){\r\n          \r\n           \r\n    //         var updatedQuantity=item?quantity-item.quantity:quantity;\r\n    //         if(updatedQuantity==0){\r\n    //             updatedQuantity=1;\r\n    //         }\r\n\r\n\r\n    //         agent.Basket.addItem(product?.id!,updatedQuantity)\r\n    //         .then(basket=>dispatch(setBasket(basket)))\r\n    //         .catch(error=>console.log(error))\r\n    //         .finally(()=>setSubmitting(false)\r\n    //         )\r\n    //     }else{\r\n            \r\n    //         const updatedQuantity=item.quantity-quantity;\r\n    //         agent.Basket.deleteItem(product?.id!,updatedQuantity)\r\n    //         .then(()=>dispatch(removeItem({productId: product?.id!,quantity: updatedQuantity}))) // update the context\r\n    //         .catch(error=>console.log(error))\r\n    //         .finally(()=>  setSubmitting(false)\r\n        \r\n    //         )\r\n    //     }\r\n\r\n    // } \r\n\r\n    const handleUpdateCart=()=>{\r\n        if(!item || quantity>item.quantity){\r\n          \r\n           \r\n            var updatedQuantity=item?quantity-item.quantity:quantity;\r\n            if(updatedQuantity==0){\r\n                updatedQuantity=1;\r\n            }\r\n\r\n\r\n            dispatch( addBasketItemAsync({productId:product?.id!,quantity:updatedQuantity}))\r\n                }else{\r\n            \r\n            const updatedQuantity=item.quantity-quantity;\r\n            \r\n            dispatch( removeBasketItemAsync({productId:product?.id!,quantity:updatedQuantity}))\r\n\r\n            \r\n        } \r\n\r\n    } \r\n    // const doFainal=()=>{ \r\n      \r\n\r\n    //     history.push('../basket');\r\n\r\n\r\n    // }\r\n    if (productStatus.includes('pending')) return (\r\n        <Loader message='Loading Product...' />\r\n    )\r\n    if (!product) return (\r\n        <NotFound />\r\n    )\r\n    return (\r\n        <Grid container spacing={6} marginTop={0}>\r\n            <Grid item xs={12} md={6}>\r\n                <img src={product.pictureUrl} alt={product.name} />\r\n            </Grid>\r\n            <Grid item xs={12} md={6}>\r\n                <Typography variant=\"h4\" color=\"initial\">{product.name}</Typography>\r\n                <Divider sx={{ borderBottomWidth: 'medium', my: 2 }} variant=\"fullWidth\" />\r\n                <Typography fontWeight=\"bolder\" color=\"primary.dark\" variant=\"h4\">\r\n                    {/* {(product.price / 100).toFixed(2)} EGP */}\r\n                    {currencyFormat(product.price)}\r\n                </Typography>\r\n                <TableContainer>\r\n                    <Table>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Name</TableCell>\r\n                                <TableCell>{product.name}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Description</TableCell>\r\n                                <TableCell>{product.description}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Type</TableCell>\r\n                                <TableCell>{product.type}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Brand</TableCell>\r\n                                <TableCell>{product.brand}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>In Stock</TableCell>\r\n                                <TableCell>{product.quantityInStock}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n\r\n                    </Table>\r\n                </TableContainer>\r\n                <Grid container spacing={2} marginTop={1}>\r\n                    <Grid item xs={6}>\r\n                        <TextField\r\n                        onChange={item?handleInputUpdateChange:handleInputAddChange}\r\n                          label=\"Quantity in cart\"\r\n                          variant='outlined'\r\n                          type='number'\r\n                          fullWidth\r\n                          value={quantity}\r\n                        />\r\n\r\n\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                        <LoadingButton \r\n                       \r\n                    \r\n\r\n                        sx={{height:'55px'}}\r\n                        color='primary'\r\n                        size='large'\r\n                        variant='contained'\r\n                        fullWidth\r\n                        loading={(status.includes('pending'))}\r\n                        disabled={(item?.quantity===quantity)||(!item&&quantity===0)}\r\n                        onClick={handleUpdateCart}\r\n                        >\r\n                            {item?'Update Quantity':'Add To Cart'}\r\n\r\n                        </LoadingButton>\r\n\r\n\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n        </Grid>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}