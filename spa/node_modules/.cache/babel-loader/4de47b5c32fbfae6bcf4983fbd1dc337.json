{"ast":null,"code":"var _jsxFileName = \"D:\\\\Learn\\\\react\\\\SouqApp\\\\spa\\\\src\\\\features\\\\catalog\\\\ProductDetails.tsx\",\n    _s = $RefreshSig$();\n\nimport Typography from '@mui/material/Typography';\nimport { useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport Grid from '@mui/material/Grid';\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\nimport agent from '../../app/api/agent';\nimport NotFound from '../../app/errors/NotFound';\nimport Loader from '../../app/layout/Loader';\nimport { currencyFormat } from '../../app/helper/helper';\nimport { LoadingButton } from '@mui/lab';\nimport { useAppDispatch, useAppSelector } from '../../app/store/configureStore';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetails() {\n  _s();\n\n  // const {basket,setBasket,removeItem}=useSouqContext(); context api\n  const {\n    basket\n  } = useAppSelector(state => state.basket); // redux\n\n  const dispatch = useAppDispatch();\n  const {\n    id\n  } = useParams();\n  const [product, setProduct] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [quantity, setQuantity] = useState(0);\n  const [submitting, setSubmitting] = useState(false);\n  const item = basket === null || basket === void 0 ? void 0 : basket.items.find(i => i.productId === (product === null || product === void 0 ? void 0 : product.id)); // const navigate = useNavigate();\n\n  useEffect(() => {\n    document.body.style.background = 'inherit';\n    if (item) setQuantity(item.quantity);\n    agent.Catalog.details(id).then(product => dispatch(setProduct(product))).catch(error => console.log(error)).finally(() => setLoading(false));\n  }, [id, item]);\n  useEffect(() => {\n    return () => {\n      document.body.style.background = '#e7e7e7';\n    };\n  }, []);\n\n  const handleInputAddChange = event => {\n    console.log('add');\n    if (event.target.value > 0) setQuantity(event === null || event === void 0 ? void 0 : event.target.value);\n  };\n\n  const handleInputUpdateChange = event => {\n    console.log('update');\n    if (event.target.value >= 0) setQuantity(event === null || event === void 0 ? void 0 : event.target.value);\n  };\n\n  const handleUpdateCart = () => {\n    setSubmitting(true);\n\n    if (!item || quantity > item.quantity) {\n      var updatedQuantity = item ? quantity - item.quantity : quantity;\n\n      if (updatedQuantity == 0) {\n        updatedQuantity = 1;\n      }\n\n      agent.Basket.addItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity).then(basket => setBasket(basket)).catch(error => console.log(error)).finally(() => setSubmitting(false));\n    } else {\n      const updatedQuantity = item.quantity - quantity;\n      agent.Basket.deleteItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity).then(() => removeItem(product === null || product === void 0 ? void 0 : product.id, updatedQuantity)) // update the context\n      .catch(error => console.log(error)).finally(() => setSubmitting(false));\n    }\n  }; // const doFainal=()=>{\n  //     history.push('../basket');\n  // }\n\n\n  if (loading) return /*#__PURE__*/_jsxDEV(Loader, {\n    message: \"Loading Product...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 9\n  }, this);\n  if (!product) return /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 9\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 6,\n    marginTop: 0,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: product.pictureUrl,\n        alt: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      md: 6,\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h4\",\n        color: \"initial\",\n        children: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          borderBottomWidth: 'medium',\n          my: 2\n        },\n        variant: \"fullWidth\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        fontWeight: \"bolder\",\n        color: \"primary.dark\",\n        variant: \"h4\",\n        children: currencyFormat(product.price)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 134,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.type\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Brand\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.brand\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"In Stock\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                children: product.quantityInStock\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 2,\n        marginTop: 1,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(TextField, {\n            onChange: item ? handleInputUpdateChange : handleInputAddChange,\n            label: \"Quantity in cart\",\n            variant: \"outlined\",\n            type: \"number\",\n            fullWidth: true,\n            value: quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 6,\n          children: /*#__PURE__*/_jsxDEV(LoadingButton, {\n            sx: {\n              height: '55px'\n            },\n            color: \"primary\",\n            size: \"large\",\n            variant: \"contained\",\n            fullWidth: true,\n            loading: submitting,\n            disabled: (item === null || item === void 0 ? void 0 : item.quantity) === quantity || !item && quantity === 0,\n            onClick: handleUpdateCart,\n            children: item ? 'Update Quantity' : 'Add To Cart'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ProductDetails, \"vToR5gkn1789xmKEij/HvQFF8cY=\", false, function () {\n  return [useAppSelector, useAppDispatch, useParams];\n});\n\n_c = ProductDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductDetails\");","map":{"version":3,"sources":["D:/Learn/react/SouqApp/spa/src/features/catalog/ProductDetails.tsx"],"names":["Typography","useEffect","useState","useParams","Grid","Divider","Table","TableCell","TableContainer","TableHead","TableRow","TextField","agent","NotFound","Loader","currencyFormat","LoadingButton","useAppDispatch","useAppSelector","ProductDetails","basket","state","dispatch","id","product","setProduct","loading","setLoading","quantity","setQuantity","submitting","setSubmitting","item","items","find","i","productId","document","body","style","background","Catalog","details","then","catch","error","console","log","finally","handleInputAddChange","event","target","value","handleInputUpdateChange","handleUpdateCart","updatedQuantity","Basket","addItem","setBasket","deleteItem","removeItem","pictureUrl","name","borderBottomWidth","my","price","description","type","brand","quantityInStock","height"],"mappings":"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","sourcesContent":["import Typography from '@mui/material/Typography'\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router'\r\nimport { Product } from '../../app/models/product';\r\nimport Grid from '@mui/material/Grid'\r\nimport { Divider, Table, TableCell, TableContainer, TableHead, TableRow, TextField } from '@mui/material';\r\nimport agent from '../../app/api/agent';\r\nimport NotFound from '../../app/errors/NotFound';\r\nimport Loader from '../../app/layout/Loader';\r\nimport { currencyFormat } from '../../app/helper/helper';\r\nimport { useSouqContext } from '../../app/context/SouqContext';\r\nimport { LoadingButton } from '@mui/lab';\r\nimport { useAppDispatch, useAppSelector } from '../../app/store/configureStore';\r\n\r\nexport default function ProductDetails() {\r\n\r\n    // const {basket,setBasket,removeItem}=useSouqContext(); context api\r\n\r\n    const {basket}=useAppSelector(state=>state.basket); // redux\r\n    const dispatch=useAppDispatch();\r\n\r\n\r\n    const { id } = useParams();\r\n    const [product, setProduct] = useState<Product | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const [quantity,setQuantity]= useState(0);\r\n    const [submitting,setSubmitting]= useState(false);\r\n\r\n    const item=basket?.items.find(i=>i.productId===product?.id);\r\n\r\n    // const navigate = useNavigate();\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        document.body.style.background = 'inherit'\r\n        if(item)setQuantity(item.quantity);\r\n        agent.Catalog.details(id!)\r\n            .then(product =>dispatch( setProduct(product)))\r\n            .catch(error => console.log(error))\r\n            .finally(() => setLoading(false))\r\n    }, [id,item])\r\n    useEffect(() => {\r\n        return () => {\r\n            document.body.style.background = '#e7e7e7'\r\n        }\r\n    }, [])\r\n\r\n    const handleInputAddChange= (event: any) =>{\r\n        console.log('add');\r\n\r\n        if(event.target.value>0)\r\n        setQuantity(event?.target.value);\r\n\r\n\r\n    }\r\n    const handleInputUpdateChange= (event: any) =>{\r\n        console.log('update');\r\n\r\n        if(event.target.value>=0)\r\n        setQuantity(event?.target.value);\r\n\r\n    }\r\n    const handleUpdateCart=()=>{\r\n        setSubmitting(true);\r\n        if(!item || quantity>item.quantity){\r\n          \r\n           \r\n            var updatedQuantity=item?quantity-item.quantity:quantity;\r\n            if(updatedQuantity==0){\r\n                updatedQuantity=1;\r\n            }\r\n\r\n\r\n            agent.Basket.addItem(product?.id!,updatedQuantity)\r\n            .then(basket=>setBasket(basket))\r\n            .catch(error=>console.log(error))\r\n            .finally(()=>setSubmitting(false)\r\n            )\r\n        }else{\r\n            \r\n            const updatedQuantity=item.quantity-quantity;\r\n            agent.Basket.deleteItem(product?.id!,updatedQuantity)\r\n            .then(()=>removeItem(product?.id!,updatedQuantity)) // update the context\r\n            .catch(error=>console.log(error))\r\n            .finally(()=>  setSubmitting(false)\r\n        \r\n            )\r\n        }\r\n\r\n    } \r\n    // const doFainal=()=>{\r\n      \r\n\r\n    //     history.push('../basket');\r\n\r\n\r\n    // }\r\n    if (loading) return (\r\n        <Loader message='Loading Product...' />\r\n    )\r\n    if (!product) return (\r\n        <NotFound />\r\n    )\r\n    return (\r\n        <Grid container spacing={6} marginTop={0}>\r\n            <Grid item xs={12} md={6}>\r\n                <img src={product.pictureUrl} alt={product.name} />\r\n            </Grid>\r\n            <Grid item xs={12} md={6}>\r\n                <Typography variant=\"h4\" color=\"initial\">{product.name}</Typography>\r\n                <Divider sx={{ borderBottomWidth: 'medium', my: 2 }} variant=\"fullWidth\" />\r\n                <Typography fontWeight=\"bolder\" color=\"primary.dark\" variant=\"h4\">\r\n                    {/* {(product.price / 100).toFixed(2)} EGP */}\r\n                    {currencyFormat(product.price)}\r\n                </Typography>\r\n                <TableContainer>\r\n                    <Table>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Name</TableCell>\r\n                                <TableCell>{product.name}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Description</TableCell>\r\n                                <TableCell>{product.description}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Type</TableCell>\r\n                                <TableCell>{product.type}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Brand</TableCell>\r\n                                <TableCell>{product.brand}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>In Stock</TableCell>\r\n                                <TableCell>{product.quantityInStock}</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n\r\n                    </Table>\r\n                </TableContainer>\r\n                <Grid container spacing={2} marginTop={1}>\r\n                    <Grid item xs={6}>\r\n                        <TextField\r\n                        onChange={item?handleInputUpdateChange:handleInputAddChange}\r\n                          label=\"Quantity in cart\"\r\n                          variant='outlined'\r\n                          type='number'\r\n                          fullWidth\r\n                          value={quantity}\r\n                        />\r\n\r\n\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                        <LoadingButton \r\n                       \r\n                    \r\n\r\n                        sx={{height:'55px'}}\r\n                        color='primary'\r\n                        size='large'\r\n                        variant='contained'\r\n                        fullWidth\r\n                        loading={submitting}\r\n                        disabled={(item?.quantity===quantity)||(!item&&quantity===0)}\r\n                        onClick={handleUpdateCart}\r\n                        >\r\n                            {item?'Update Quantity':'Add To Cart'}\r\n\r\n                        </LoadingButton>\r\n\r\n\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n        </Grid>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}